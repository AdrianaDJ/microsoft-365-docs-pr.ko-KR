---
title: Office 365 고객 키에 대 한 가용성 키에 대 한 자세한 정보
ms.author: krowley
author: kccross
manager: laurawi
ms.date: 02/05/2020
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
description: 손실 된 Office 365 고객 키를 복구 하는 데 사용 되는 가용성 키에 대해 알아봅니다.
ms.openlocfilehash: b363d3b90c6ea783bd051bea6c44a94689b87ac1
ms.sourcegitcommit: 5ff1dc62e8855be155cb2de45cf4ee5a02c321fd
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 02/06/2020
ms.locfileid: "41804839"
---
# <a name="learn-about-the-availability-key-for-office-365-customer-key"></a><span data-ttu-id="2f198-103">Office 365 고객 키에 대 한 가용성 키에 대 한 자세한 정보</span><span class="sxs-lookup"><span data-stu-id="2f198-103">Learn about the availability key for Office 365 Customer Key</span></span>

<span data-ttu-id="2f198-104">가용성 키는 데이터 암호화 정책을 만들 때 자동으로 생성 되 고 프로 비전 되는 루트 키입니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-104">The availability key is a root key automatically generated and provisioned when you create a data encryption policy.</span></span> <span data-ttu-id="2f198-105">Office 365에서는 가용성 키를 저장 하 고 보호 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-105">Office 365 stores and protects the availability key.</span></span> <span data-ttu-id="2f198-106">가용성 키는 고객 키를 사용한 서비스 암호화에 제공 되는 두 가지 루트 키와 기능적으로 비슷합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-106">The availability key is functionally similar to the two root keys that you supply for service encryption with Customer Key.</span></span> <span data-ttu-id="2f198-107">가용성 키는 키 계층 구조에서 1 계층 보다 작은 키를 배치 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-107">The availability key wraps the keys one tier lower in the key hierarchy.</span></span> <span data-ttu-id="2f198-108">Azure 키 자격 증명 모음에서 제공 하 고 관리 하는 키와 달리 가용성 키에 직접 액세스할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-108">Unlike the keys that you provide and manage in Azure Key Vault, you can't directly access the availability key.</span></span> <span data-ttu-id="2f198-109">Office 365 자동 서비스 PowerShell cmdlet을 사용 하 여 가용성 키를 관리 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-109">Office 365 automated services manage the availability key using PowerShell cmdlets.</span></span> <span data-ttu-id="2f198-110">이러한 cmdlet은 가용성 키에 직접 액세스 하지 않는 자동화 된 작업을 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-110">These cmdlets initiate automated operations that never involve direct access to the availability key.</span></span>

<span data-ttu-id="2f198-111">가용성 키의 기본 목적은 사용자가 관리 하는 예상 루트 키 손실 로부터 복구 기능을 제공 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-111">The primary purpose of the availability key is to provide recovery capability from the unanticipated loss of root keys that you manage.</span></span> <span data-ttu-id="2f198-112">Mismanagement 또는 악의적인 작업의 결과로 손실 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-112">Loss could be a result of mismanagement or malicious action.</span></span> <span data-ttu-id="2f198-113">루트 키를 제어할 수 없는 경우 microsoft 지원 서비스에 문의 하 여 가용성 키를 사용한 복구 프로세스를 지원 해 드릴 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-113">If you lose control of your root keys, contact Microsoft Support and Microsoft will assist you through the process of recovery using the availability key.</span></span> <span data-ttu-id="2f198-114">가용성 키를 사용 하 여 새로운 루트 키를 프로 비전 한 새 데이터 암호화 정책으로 마이그레이션합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-114">You'll use the availability key to migrate to a new Data Encryption Policy with new root keys you provision.</span></span>

<span data-ttu-id="2f198-115">가용성 키에 대 한 저장소 및 제어는 다음과 같은 세 가지 이유로 인해 Azure 키 보관소와는 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-115">Storage and control of the availability key are deliberately different from Azure Key Vault keys for three reasons:</span></span>

- <span data-ttu-id="2f198-116">가용성 키를 사용 하면 두 Azure 키를 모두 제어할 수 없는 경우 "고장 유리" 기능을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-116">The availability key provides a recovery, "break-glass" capability if control over both Azure Key Vault keys is lost.</span></span>
- <span data-ttu-id="2f198-117">논리적 컨트롤과 안전한 저장소 위치를 분리 하면 단일 공격이 나 실패 지점에서 모든 키 및 데이터 손실을 방지 하 고 보안을 강화 하 고 보호할 수가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-117">The separation of logical controls and secure storage locations provides defense-in-depth and protects against the loss of all keys, and your data, from a single attack or point of failure.</span></span>
- <span data-ttu-id="2f198-118">Office 365 서비스가 일시적인 오류로 인해 Azure 키 자격 증명 모음에 호스트 된 키에 연결할 수 없는 경우 가용성 키를 통해 고가용성 기능을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-118">The availability key provides a high-availability capability if Office 365 services are unable to reach keys hosted in Azure Key Vault due to transient errors.</span></span> <span data-ttu-id="2f198-119">이 규칙은 Exchange Online 및 비즈니스용 Skype 서비스 암호화에만 적용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-119">This rule only applies to Exchange Online and Skype for Business service encryption.</span></span> <span data-ttu-id="2f198-120">SharePoint Online, 비즈니스용 OneDrive 및 팀 파일은 Microsoft가 복구 프로세스를 시작 하도록 명시적으로 지시 하지 않으면 가용성 키를 사용 하지 않는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-120">SharePoint Online, OneDrive for Business, and Teams files never use the availability key unless you explicitly instruct Microsoft to initiate the recovery process.</span></span>

<span data-ttu-id="2f198-121">키 관리에 대 한 다양 한 보호 및 프로세스를 사용 하 여 데이터를 보호 하는 책임을 공유 하면 결국 모든 키 (즉, 데이터)가 영구적으로 손실 되거나 소멸 되는 위험을 줄일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-121">Sharing the responsibility to protect your data, using a variety of protections and processes for key management, ultimately reduces the risk that all keys (and therefore your data) will be permanently lost or destroyed.</span></span> <span data-ttu-id="2f198-122">Microsoft는 서비스를 떠날 때 가용성 키를 비활성화 기능이 하는 단독 기관을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-122">Microsoft provides you with sole authority over the disablement or destruction of the availability key when you leave the service.</span></span> <span data-ttu-id="2f198-123">Microsoft의 가용성 키에 대 한 액세스 권한이 있는 아무도 Office 365 서비스 코드 에서만 액세스할 수 있도록 디자인 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-123">By design, no one at Microsoft has access to the availability key: it is only accessible by Office 365 service code.</span></span>

<span data-ttu-id="2f198-124">키를 보호 하는 방법에 대 한 자세한 내용은 [Microsoft 보안 센터](https://www.microsoft.com/trustcenter/Privacy/govt-requests-for-data) 를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="2f198-124">See the [Microsoft Trust Center](https://www.microsoft.com/trustcenter/Privacy/govt-requests-for-data) for more information about how we secure keys.</span></span>
  
## <a name="availability-key-uses"></a><span data-ttu-id="2f198-125">가용성 키 사용</span><span class="sxs-lookup"><span data-stu-id="2f198-125">Availability key uses</span></span>

<span data-ttu-id="2f198-126">가용성 키는 외부 malefactor 또는 악의적인 사용자가 키 자격 증명 모음을 도용 하거나 실수로 mismanagement 경우 루트 키가 손실 되는 경우의 복구 기능을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-126">The availability key provides recovery capability for scenarios in which an external malefactor or malicious insider steals control of your key vault, or when inadvertent mismanagement results in loss of root keys.</span></span> <span data-ttu-id="2f198-127">이 복구 기능은 고객 키와 호환 되는 모든 Office 365 서비스에 적용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-127">This recovery capability applies to all Office 365 services compatible with Customer Key.</span></span> <span data-ttu-id="2f198-128">개별 서비스에서는 가용성 키를 다르게 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-128">Individual services use the availability key differently.</span></span> <span data-ttu-id="2f198-129">Office 365은 아래 설명 된 방법 으로만 가용성 키를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-129">Office 365 only uses the availability key in the ways described below.</span></span>

### <a name="exchange-online-and-skype-for-business-uses"></a><span data-ttu-id="2f198-130">Exchange Online 및 비즈니스용 Skype 사용</span><span class="sxs-lookup"><span data-stu-id="2f198-130">Exchange Online and Skype for Business uses</span></span>

<span data-ttu-id="2f198-131">복구 기능 외에도 Exchange Online 및 비즈니스용 Skype는 가용성 키를 사용 하 여 일시적으로 또는 일시적인 운영 문제 중에는 루트 키에 액세스 하는 서비스와 관련 된 데이터 가용성을 보장 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-131">In addition to the recovery capability, Exchange Online and Skype for Business use the availability key to ensure data availability during transient, or intermittent operational issues, related to the service accessing root keys.</span></span> <span data-ttu-id="2f198-132">서비스가 일시적인 오류로 인해 Azure 키 자격 증명 모음의 고객 키에 연결할 수 없는 경우 서비스에서 자동으로 가용성 키를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-132">When the service cannot reach either of your Customer Keys in Azure Key Vault due to transient errors, the service automatically uses the availability key.</span></span> <span data-ttu-id="2f198-133">서비스가 가용성 키로 직접 이동 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-133">The service NEVER goes directly to the availability key.</span></span>

<span data-ttu-id="2f198-134">Exchange Online 및 비즈니스용 Skype의 자동화 된 시스템은 일시적인 오류가 발생 하는 경우 가용성 키를 사용 하 여 바이러스 백신, 전자 검색, 데이터 손실 방지, 사서함 이동 및 데이터 인덱싱과 같은 자동화 된 백 엔드 서비스를 지원할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-134">Automated systems in Exchange Online and Skype for Business may use the availability key during transient errors to support automated back-end services such as anti-virus, e-discovery, data loss prevention, mailbox moves, and data indexing.</span></span>

### <a name="sharepointonlineonedriveforbusinessandteamsfiles-uses"></a><span data-ttu-id="2f198-135">SharePoint Online, 비즈니스용 OneDrive 및 팀 파일에서는 다음을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-135">SharePoint Online, OneDrive for Business, and Teams files uses</span></span>

<span data-ttu-id="2f198-136">SharePoint Online, 비즈니스용 OneDrive 및 팀 파일의 경우 가용성 키가 복구 기능 외부에서 사용 되지 않으며, 고객은 복구 시나리오에서 가용성 키 사용을 시작 하도록 Microsoft에 명시적으로 지시 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-136">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is NEVER used outside of the recovery capability and customers must explicitly instruct Microsoft to initiate use of the availability key during a recovery scenario.</span></span> <span data-ttu-id="2f198-137">자동화 된 서비스 작업은 Azure 키 자격 증명 모음의 고객 키에만 의존 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-137">Automated service operations solely rely on your Customer Keys in Azure Key vault.</span></span> <span data-ttu-id="2f198-138">이러한 서비스에 대해 키 계층 구조가 작동 하는 방식에 대 한 자세한 내용은 [SharePoint Online, 비즈니스용 OneDrive 및 팀 파일에서 가용성 키를 사용](#how-sharepoint-online-onedrive-for-business-and-teams-files-use-the-availability-key)하는 방법을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="2f198-138">For in-depth information about how the key hierarchy works for these services, see [How SharePoint Online, OneDrive for Business, and Teams files use the availability key](#how-sharepoint-online-onedrive-for-business-and-teams-files-use-the-availability-key).</span></span>

## <a name="availability-key-security"></a><span data-ttu-id="2f198-139">가용성 키 보안</span><span class="sxs-lookup"><span data-stu-id="2f198-139">Availability key security</span></span>

<span data-ttu-id="2f198-140">Microsoft는 가용성 키를 인스턴스화하고이를 보호 하기 위해 광범위 한 조치를 취하는 방식으로 데이터 보호 책임을 공유 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-140">Microsoft shares the responsibility of data protection with you by instantiating the availability key and taking extensive measures to protect it.</span></span> <span data-ttu-id="2f198-141">Microsoft는 가용성 키에 대 한 직접 제어를 고객에 게 공개 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-141">Microsoft does not expose direct control of the availability key to customers.</span></span> <span data-ttu-id="2f198-142">예를 들어 Azure Key Vault에서 소유한 키만 롤 (회전) 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-142">For example, you can only roll (rotate) the keys that you own in Azure Key Vault.</span></span> <span data-ttu-id="2f198-143">자세한 내용은 [고객 키 또는 가용성 키 롤 또는 회전을](customer-key-availability-key-roll.md)참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="2f198-143">For more information, see [Roll or rotate a customer key or an availability key](customer-key-availability-key-roll.md).</span></span>

### <a name="availability-key-secret-stores"></a><span data-ttu-id="2f198-144">가용성 키 보안 저장소</span><span class="sxs-lookup"><span data-stu-id="2f198-144">Availability key secret stores</span></span>

<span data-ttu-id="2f198-145">Microsoft는 고객 연결 Azure 키 보관소와 유사 하 게 액세스 제어, 내부 비밀 저장소의 가용성 키를 보호 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-145">Microsoft protects availability keys in access-controlled, internal secret stores similar to the customer-facing Azure Key Vault.</span></span> <span data-ttu-id="2f198-146">Microsoft 관리자가에 포함 된 암호에 직접 액세스 하지 못하도록 액세스 제어를 구현 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-146">We implement access controls to prevent Microsoft administrators from directly accessing the secrets contained within.</span></span> <span data-ttu-id="2f198-147">키 순환, 삭제 및 검색을 비롯 한 보안 저장소 작업은 가용성 키에 직접 액세스 하지 않는 자동화 된 명령을 통해 수행 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-147">Secret Store operations, including key rotation, deletion, and retrieval occur through automated commands that never involve direct access to the availability key.</span></span> <span data-ttu-id="2f198-148">이 명령에 대 한 액세스는 특정 엔지니어만 사용할 수 있으며 내부 도구인 Lockbox를 통해 권한 에스컬레이션이 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-148">Access to adjust these commands is limited to specific engineers and requires privilege escalation through an internal tool, Lockbox.</span></span> <span data-ttu-id="2f198-149">권한 에스컬레이션을 사용 하려면 관리자 승인 및 근거를 부여 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-149">Privilege escalation requires manager approval and justification prior to being granted.</span></span> <span data-ttu-id="2f198-150">Lockbox는 시간이 만료 되거나 로그 아웃 될 때 자동 액세스 해지와의 시간 제한이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-150">Lockbox ensures access is time bound with automatic access revocation upon time expiration or engineer log out.</span></span>

<span data-ttu-id="2f198-151">**Exchange Online 및 비즈니스용 Skype** 사용 가능 여부 키는 Active Directory 비밀 저장소에 저장 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-151">**Exchange Online and Skype for Business** availability keys are stored in an Active Directory secret store.</span></span> <span data-ttu-id="2f198-152">Exchange Online Active Directory는 개체, id 및 데이터를 포함 하는 트래픽 및 용량 포리스트를 라우팅하는 관리 포리스트로 구성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-152">Exchange Online Active Directory is comprised of Management forests that route traffic and Capacity forests that contain objects, identities, and data.</span></span> <span data-ttu-id="2f198-153">용량 포리스트는 계정 포리스트와 리소스 포리스트로 구성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-153">Capacity forests consist of Account forests and Resource forests.</span></span> <span data-ttu-id="2f198-154">계정 포리스트에는 서로 동기화 되는 여러 용량 도메인 컨트롤러가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-154">Account forests have multiple Capacity domain controllers that are synced with one another.</span></span> <span data-ttu-id="2f198-155">가용성 키는 이러한 용량 도메인 컨트롤러 내에 안전 하 게 저장 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-155">Availability keys are securely stored within these Capacity domain controllers.</span></span> <span data-ttu-id="2f198-156">이 보안 저장소 위치는 SharePoint Online, 비즈니스용 OneDrive 및 팀 파일 비밀 저장소와 분리 되어 격리 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-156">This secure storage location is separate and isolated from the SharePoint Online, OneDrive for Business, and Teams files secret store.</span></span>

<span data-ttu-id="2f198-157">**SharePoint Online, 비즈니스용 OneDrive 및 팀 파일** 가용성 키는 서비스 팀이 관리 하는 내부 비밀 저장소에 저장 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-157">**SharePoint Online, OneDrive for Business, and Teams files** availability keys are stored in an internal secret store managed by the service team.</span></span> <span data-ttu-id="2f198-158">이 보안, 비밀 저장소 서비스는 응용 프로그램 끝점과 SQL 데이터베이스를 백 엔드로 사용 하는 프런트 엔드 서버를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-158">This secured, secrets storage service has front-end servers with application endpoints and a SQL database as the back-end.</span></span> <span data-ttu-id="2f198-159">가용성 키는 SQL 데이터베이스에 저장 되며, AES-256와 HMAC를 함께 사용 하 여 rest에서 가용성 키를 암호화 하는 비밀 저장소 암호화 키로 래핑 (암호화) 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-159">Availability keys are stored in the SQL database and are wrapped (encrypted) by secret store encryption keys that use a combination of AES-256 and HMAC to encrypt the availability key at rest.</span></span> <span data-ttu-id="2f198-160">보안 저장소 암호화 키는 동일한 SQL 데이터베이스의 논리적으로 분리 된 구성 요소에 저장 되며 Microsoft CA (인증 기관)에서 관리 하는 인증서에 포함 된 RSA-2048 키를 통해 추가로 암호화 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-160">The secret store encryption keys are stored in a logically isolated component of the same SQL database and are further encrypted with RSA-2048 keys contained in certificates managed by the Microsoft certificate authority (CA).</span></span> <span data-ttu-id="2f198-161">이러한 인증서는 데이터베이스에 대 한 작업을 수행 하는 보안 저장소 프런트 엔드 서버에 저장 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-161">These certificates are stored in the secret store front-end servers that perform operations against the database.</span></span>

### <a name="defense-in-depth"></a><span data-ttu-id="2f198-162">심층 방어</span><span class="sxs-lookup"><span data-stu-id="2f198-162">Defense-in-depth</span></span>

<span data-ttu-id="2f198-163">Microsoft는 악의적인 행위자가 Microsoft 클라우드에 저장 된 고객 데이터의 기밀성, 무결성 또는 가용성에 영향을 주지 않도록 하는 심층 방어 전략을 채택 하 고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-163">Microsoft employs a defense-in-depth strategy to prevent malicious actors from impacting the confidentiality, integrity, or availability of customer data stored in the Microsoft Cloud.</span></span> <span data-ttu-id="2f198-164">중요 한 보안 전략의 일환으로 가용성 키를 보호 하기 위해 특정 예방 및 예방용 인지 컨트롤이 구현 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-164">Specific preventive and detective controls are implemented to protect the availability key as part of the overarching security strategy.</span></span>

<span data-ttu-id="2f198-165">가용성 키의 오용을 방지 하기 위해 Office 365이 구축 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-165">Office 365 is built to prevent misuse of the availability key.</span></span> <span data-ttu-id="2f198-166">응용 프로그램 계층은 가용성 키를 비롯 한 키를 사용 하 여 데이터를 암호화 하 고 암호를 해독 하는 유일한 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-166">The application layer is the only method through which keys, including the availability key, can be used to encrypt and decrypt data.</span></span> <span data-ttu-id="2f198-167">Office 365 서비스 코드에만 암호화 및 암호 해독 작업을 위한 키 계층 구조를 해석 하 고 트래버스할 수 있는 기능이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-167">Only Office 365 service code has the ability to interpret and traverse the key hierarchy for encryption and decryption activities.</span></span> <span data-ttu-id="2f198-168">악의적인 Microsoft 관리자가 제어를 우회 하 여 비밀 저장소에서 가용성 키를 추출 하는 경우에는 해당 키를 사용 하 여 고객 데이터에 액세스할 수 없게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-168">If a malicious Microsoft administrator were to circumvent controls to extract an availability key from the secret store, the key would be unusable to access customer data.</span></span> <span data-ttu-id="2f198-169">논리적 격리는 고객 키, 가용성 키, 기타 계층 구조 키 및 고객 데이터의 저장 위치 사이에 존재 하며 하나 이상의 위치가 손상 되는 경우 데이터 노출 위험을 완화 하는 데 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-169">Logical isolation exists between the storage locations of Customer Keys, availability keys, other hierarchical keys, and customer data, which mitigates the risk of data exposure in the event one or more locations are compromised.</span></span>

<span data-ttu-id="2f198-170">액세스 제어는 가용성 키 보안 저장소를 포함 하 여 내부 시스템에 대 한 무단 액세스를 방지 하기 위해 구현 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-170">Access controls are implemented to prevent unauthorized access to internal systems, including availability key secret stores.</span></span> <span data-ttu-id="2f198-171">Microsoft 엔지니어가 가용성 키 보안 저장소에 직접 액세스할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-171">Microsoft engineers don't have direct access to the availability key secret stores.</span></span> <span data-ttu-id="2f198-172">액세스 제어에 대 한 자세한 내용은 [Office 365에서 관리 액세스 제어](https://docs.microsoft.com/Office365/securitycompliance/office-365-administrative-access-controls-overview)를 검토 하십시오.</span><span class="sxs-lookup"><span data-stu-id="2f198-172">For additional detail on access controls, review [Administrative Access Controls in Office 365](https://docs.microsoft.com/Office365/securitycompliance/office-365-administrative-access-controls-overview).</span></span>

<span data-ttu-id="2f198-173">기술 제어는 Microsoft 담당자가 높은 권한의 서비스 계정에 로그인 하지 못하도록 차단 하며,이는 공격자가 Office 365 서비스를 가장 하는 데 사용 될 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-173">Technical controls prevent Microsoft personnel from logging into highly-privileged service accounts, which might otherwise be used by attackers to impersonate Office 365 services.</span></span> <span data-ttu-id="2f198-174">예를 들어 이러한 컨트롤은 대화형 로그온을 방지 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-174">For example, these controls prevent interactive logon.</span></span>

<span data-ttu-id="2f198-175">보안 로깅 및 모니터링 제어는 Microsoft 서비스 및 데이터에 대 한 위험을 완화 하는 또 다른 심층 방어 방지 수단입니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-175">Security logging and monitoring controls are another defense-in-depth safeguard implemented that mitigate risk to Microsoft services and your data.</span></span> <span data-ttu-id="2f198-176">Microsoft 서비스 팀은 경고 및 감사 로그를 생성 하는 활성 모니터링 솔루션을 배포 했습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-176">Microsoft service teams have deployed active monitoring solutions that generate alerts and audit logs.</span></span> <span data-ttu-id="2f198-177">모든 서비스 팀은 로그를 집계 하 고 처리 하는 중앙 리포지토리에 로그를 업로드 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-177">All service teams upload their logs to a central repository where the logs are aggregated and processed.</span></span> <span data-ttu-id="2f198-178">내부 도구는 자동으로 레코드를 검사 하 여 서비스가 최적의 상태 이며 탄력적 이며 안전한 상태로 작동 하 고 있는지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-178">Internal tools automatically examine records to confirm that services are functioning in an optimal, resilient, and secure state.</span></span> <span data-ttu-id="2f198-179">이상한 활동에는 추가 검토를 위해 플래그가 지정 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-179">Unusual activity is flagged for further review.</span></span>

<span data-ttu-id="2f198-180">Microsoft 보안 정책에 대 한 잠재적 위반을 나타내는 모든 로그 이벤트는 Microsoft 보안 팀의 주의를 통해 즉시 제공 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-180">Any log event that indicates a potential violation of the Microsoft Security Policy is immediately brought to the attention of Microsoft security teams.</span></span> <span data-ttu-id="2f198-181">Office 365 보안에서는 가용성 키 보안 저장소에 대 한 시도 된 액세스를 검색 하도록 알림을 구성 했습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-181">Office 365 security has configured alerts to detect attempted access to availability key secret stores.</span></span> <span data-ttu-id="2f198-182">Microsoft 직원이 서비스 계정에 대화형 로그온을 시도 하는 경우 (액세스 제어에 의해 금지 및 보호 됨)에도 경고가 생성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-182">Alerts are also generated if Microsoft personnel attempt interactive logon to service accounts, which is prohibited and protected by access controls.</span></span> <span data-ttu-id="2f198-183">Office 365 보안은 일반 초기 작업에서 Office 365 서비스의 편차를 감지 하 고 알림을 발생 하기도 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-183">Office 365 security also detects and alerts upon deviations of the Office 365 service from normal baseline operations.</span></span> <span data-ttu-id="2f198-184">Office 365 서비스를 악용 하려고 시도 하면 Microsoft 클라우드 환경에서 Malefactors의 제거를 유발 하는 경고가 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-184">Malefactors attempting to misuse Office 365 services would trigger alerts resulting in the offender's eviction from the Microsoft cloud environment.</span></span>

## <a name="use-the-availability-key-to-recover-from-key-loss"></a><span data-ttu-id="2f198-185">가용성 키를 사용 하 여 키 손실 복구</span><span class="sxs-lookup"><span data-stu-id="2f198-185">Use the availability key to recover from key loss</span></span>

<span data-ttu-id="2f198-186">고객 키에 대 한 제어 권한이 없는 경우 가용성 키를 통해 데이터를 복구 하 고 다시 암호화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-186">If you lose control of your Customer Keys, the availability key provides you the ability to recover and re-encrypt your data.</span></span>

### <a name="recovery-procedure-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="2f198-187">Exchange Online 및 비즈니스용 Skype에 대 한 복구 절차</span><span class="sxs-lookup"><span data-stu-id="2f198-187">Recovery procedure for Exchange Online and Skype for Business</span></span>

<span data-ttu-id="2f198-188">고객 키를 제어할 수 없는 경우에도를 복구 하는 동안 가용성 키를 통해 데이터에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-188">If you lose control of your Customer Keys, the availability key will still provide you access to your data while you recover.</span></span> <span data-ttu-id="2f198-189">새 고객 키를 사용 하 여 데이터를 암호화 하려면 Azure Key Vault에서 새 키를 만들고 새 dep를 만든 다음 새 사용자 키에 연결 하 고, 키가 손실 되거나 삭제 된 이전 DEP에서 현재 암호화 된 사서함을 암호화 하도록 DEP에 지시 합니다. omised.</span><span class="sxs-lookup"><span data-stu-id="2f198-189">To encrypt your data with new Customer Keys, create new keys in Azure Key Vault, create a new DEP, associate the new DEP to your new Customer Keys, then instruct the DEP to encrypt the mailboxes currently encrypted with the previous DEP for which the keys were lost or compromised.</span></span> <span data-ttu-id="2f198-190">이를 수행 하면 가용성 키가 사서함의 암호를 해독 한 다음 새 정책으로 암호화 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-190">When performed, the availability key will decrypt the mailboxes which will then be encrypted with the new policy.</span></span>

<span data-ttu-id="2f198-191">이 프로세스에는 DEP를 변경할 때의 표준 기간인 최대 72 시간이 소요 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-191">This process can take up to 72 hours, which is the standard duration when you change a DEP.</span></span>
  
### <a name="recovery-procedure-for-sharepointonlineonedriveforbusinessandteamsfiles"></a><span data-ttu-id="2f198-192">SharePoint Online, 비즈니스용 OneDrive 및 팀 파일에 대 한 복구 절차</span><span class="sxs-lookup"><span data-stu-id="2f198-192">Recovery procedure for SharePoint Online, OneDrive for Business, and Teams files</span></span>

<span data-ttu-id="2f198-193">SharePoint Online, 비즈니스용 OneDrive 및 팀 파일의 경우에는 가용성 키가 복구 기능 외부에서 사용 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-193">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is NEVER used outside of the recovery capability.</span></span> <span data-ttu-id="2f198-194">복구 시나리오에서 가용성 키 사용을 시작 하도록 Microsoft에 명시적으로 지시 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-194">You must explicitly instruct Microsoft to initiate use of the availability key during a recovery scenario.</span></span> <span data-ttu-id="2f198-195">복구 프로세스를 시작 하려면 Microsoft에 가용성 키를 활성화 하도록 요청 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-195">To initiate the recovery process, contact Microsoft to activate the availability key.</span></span> <span data-ttu-id="2f198-196">일단 활성화 되 면 가용성 키가 새 고객 키와 연결 된 새로 만든 DEP로 데이터를 암호화할 수 있도록 데이터 암호를 해독 하는 데 자동으로 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-196">Once activated, the availability key is automatically used to decrypt your data allowing you to encrypt the data with a newly-created DEP associated to new Customer Keys.</span></span>  

<span data-ttu-id="2f198-197">이 작업은 조직의 사이트 수에 비례 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-197">This operation is proportional to the number of sites in your organization.</span></span> <span data-ttu-id="2f198-198">Microsoft에 전화를 걸어 가용성 키를 사용 하려면 약 4 시간 이내에 완벽 하 게 온라인 상태 여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-198">Once you call Microsoft to use the availability key, you should be fully online within about four hours.</span></span>

## <a name="how-exchange-online-and-skype-for-business-use-the-availability-key"></a><span data-ttu-id="2f198-199">Exchange Online 및 비즈니스용 Skype에서 가용성 키를 사용 하는 방법</span><span class="sxs-lookup"><span data-stu-id="2f198-199">How Exchange Online and Skype for Business use the availability key</span></span>

<span data-ttu-id="2f198-200">고객 키를 사용 하 여 DEP를 만들면 Office 365에서 해당 DEP와 연결 된 DEP 키 (데이터 암호화 정책 키)를 생성 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-200">When you create a DEP with Customer Key, Office 365 generates a Data Encryption Policy Key (DEP Key) associated with that DEP.</span></span> <span data-ttu-id="2f198-201">서비스는 두 번의 각 고객 키와 가용성 키를 사용 하 여 DEP 키를 3 회 암호화 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-201">The service encrypts the DEP Key three times: once with each of the customer keys and once with the availability key.</span></span> <span data-ttu-id="2f198-202">암호화 된 버전의 DEP 키만 저장 되 고, DEP 키는 고객 키 또는 가용성 키로만 해독 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-202">Only the encrypted versions of the DEP Key are stored, and a DEP Key can only be decrypted with the customer keys or the availability key.</span></span> <span data-ttu-id="2f198-203">그런 다음 개별 사서함을 암호화 하는 데 사용 되는 사서함 키를 암호화 하는 데 DEP 키를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-203">The DEP Key is then used to encrypt Mailbox Keys, which are then used to encrypt individual mailboxes.</span></span> 
  
<span data-ttu-id="2f198-204">서비스를 사용할 때 Office 365에서 다음 프로세스를 수행 하 여 데이터를 해독 하 고 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-204">Office 365 follows this process to decrypt and provide data when customers are using the service:</span></span>
  
1. <span data-ttu-id="2f198-205">고객 키를 사용 하 여 DEP 키의 암호를 해독 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-205">Decrypt the DEP Key using the Customer Key.</span></span>

2. <span data-ttu-id="2f198-206">암호 해독 된 DEP 키를 사용 하 여 사서함 키를 해독 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-206">Use the decrypted DEP Key to decrypt a Mailbox Key.</span></span>

3. <span data-ttu-id="2f198-207">암호 해독 된 사서함 키를 사용 하 여 사서함 자체의 암호를 해독 하 여 사서함 내의 데이터에 액세스할 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-207">Use the decrypted Mailbox Key to decrypt the mailbox itself, allowing you to access the data within the mailbox.</span></span>

<span data-ttu-id="2f198-208">Office 365에서는 오프셋을 약간 사용 하 여 Azure Key Vault에 두 개의 암호 해독 요청을 실행 하 여 DEP 키를 해독 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-208">Office 365 decrypts a DEP Key by issuing two decryption requests to Azure Key Vault with a slight offset.</span></span> <span data-ttu-id="2f198-209">처음에는 검색을 완료 하 여 결과를 제공 다른 요청을 취소 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-209">The first one to finish furnishes the result, canceling the other request.</span></span>

## <a name="how-sharepoint-online-onedrive-for-business-and-teams-files-use-the-availability-key"></a><span data-ttu-id="2f198-210">SharePoint Online, 비즈니스용 OneDrive 및 팀 파일은 가용성 키를 사용 하는 방법</span><span class="sxs-lookup"><span data-stu-id="2f198-210">How SharePoint Online, OneDrive for Business, and Teams files use the availability key</span></span>

<span data-ttu-id="2f198-211">고객 키 및 가용성 키에 대 한 SharePoint Online 및 비즈니스용 OneDrive 아키텍처 및 구현은 Exchange Online 및 비즈니스용 Skype와 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-211">The SharePoint Online and OneDrive for Business architecture and implementation for Customer Key and availability key are different from Exchange Online and Skype for Business.</span></span>
  
<span data-ttu-id="2f198-212">조직이 고객 관리 키로 이동 하면 Office 365에서 테 넌 트 관련 중간 키 (TIK)를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-212">When an organization moves to customer-managed keys, Office 365 creates a tenant-specific intermediate key (TIK).</span></span> <span data-ttu-id="2f198-213">Office 365에서는 각 고객 키와 함께 TIK를 두 번 암호화 하 고 두 가지 암호화 버전의 TIK를 저장 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-213">Office 365 encrypts the TIK twice, once with each of the customer keys, and stores the two encrypted versions of the TIK.</span></span> <span data-ttu-id="2f198-214">암호화 된 버전의 TIK만 저장 되 고, TIK는 customer 키로만 암호를 해독할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-214">Only the encrypted versions of the TIK are stored, and a TIK can only be decrypted with the customer keys.</span></span> <span data-ttu-id="2f198-215">그런 다음 TIK는 blob 키 (파일 청크 키 라고도 함)를 암호화 하는 데 사용 되는 사이트 키를 암호화 하는 데 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-215">The TIK is then used to encrypt site keys, which are then used to encrypt blob keys (also called file chunk keys).</span></span> <span data-ttu-id="2f198-216">파일 크기에 따라 서비스에서는 각각 고유한 키를 사용 하 여 파일을 여러 파일 청크로 분할할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-216">Depending on file size, the service may split a file into multiple file chunks each with a unique key.</span></span> <span data-ttu-id="2f198-217">Blob 키를 사용 하 여 blob (파일 청크) 자체를 암호화 하 고 Microsoft Azure Blob 저장소 서비스에 저장 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-217">The blobs (file chunks) themselves are encrypted with the blob keys and stored in the Microsoft Azure Blob storage service.</span></span>
  
<span data-ttu-id="2f198-218">고객이 서비스를 사용할 때 고객 파일의 암호를 해독 하 고 제공 하기 위한 Office 365는 다음과 같은 프로세스를 따릅니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-218">Office 365 follows this process to decrypt and provide customer files when customers are using the service:</span></span>

1. <span data-ttu-id="2f198-219">고객 키를 사용 하 여 TIK의 암호를 해독 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-219">Decrypt the TIK using the Customer Key.</span></span>

2. <span data-ttu-id="2f198-220">암호 해독 된 TIK를 사용 하 여 사이트 키의 암호를 해독 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-220">Use the decrypted TIK to decrypt a site key.</span></span>

3. <span data-ttu-id="2f198-221">암호 해독 된 사이트 키를 사용 하 여 blob 키를 해독 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-221">Use the decrypted site key to decrypt a blob key.</span></span>

4. <span data-ttu-id="2f198-222">해독 된 blob 키를 사용 하 여 blob 암호를 해독 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-222">Use the decrypted blob key to decrypt the blob.</span></span>

<span data-ttu-id="2f198-223">Office 365에서는 오프셋을 약간 사용 하 여 Azure Key Vault에 두 개의 암호 해독 요청을 실행 하 여 TIK를 해독 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-223">Office 365 decrypts a TIK by issuing two decryption requests to Azure Key Vault with a slight offset.</span></span> <span data-ttu-id="2f198-224">처음에는 검색을 완료 하 여 결과를 제공 다른 요청을 취소 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-224">The first one to finish furnishes the result, canceling the other request.</span></span>
  
<span data-ttu-id="2f198-225">고객 키에 대 한 액세스 권한이 없는 경우 Office 365 에서도 사용 가능 키를 사용 하 여 TIK를 암호화 하 고 각 고객 키를 사용 하 여 암호화 된 Tik와 함께이를 저장 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-225">In case you lose access to your customer keys, Office 365 also encrypts the TIK with an availability key and stores this along with the TIKs encrypted with each customer key.</span></span> <span data-ttu-id="2f198-226">가용성 키를 사용 하 여 암호화 된 TIK는 고객이 악의적으로 또는 실수로 키에 대 한 액세스 권한을 손실 했을 때 복구 경로를 등록 해야 하는 경우에만 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-226">The TIK encrypted with the availability key is used only when the customer calls Microsoft to enlist the recovery path when they have lost access to their keys, maliciously or accidentally.</span></span>
  
<span data-ttu-id="2f198-227">가용성 및 확장 상의 이유로, 암호 해독 된 TIKs는 시간 제한 메모리 캐시에 캐시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-227">For availability and scale reasons, decrypted TIKs are cached in a time-limited memory cache.</span></span> <span data-ttu-id="2f198-228">TIK 캐시가 만료 되도록 설정 되기까지 두 시간이 소요 되 면 Office 365에서 각 TIK를 해독 하려고 시도 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-228">Two hours before a TIK cache is set to expire, Office 365 attempts to decrypt each TIK.</span></span> <span data-ttu-id="2f198-229">TIKs를 해독 하면 캐시의 수명이 연장 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-229">Decrypting the TIKs extends the lifetime of the cache.</span></span> <span data-ttu-id="2f198-230">TIK 암호 해독에 실패 하는 경우, Office 365는 캐시 만료 전에 엔지니어링에 알리기 위한 경고를 생성 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-230">If TIK decryption fails for a significant amount of time, Office 365 generates an alert to notify engineering prior to the cache expiration.</span></span> <span data-ttu-id="2f198-231">고객이 Microsoft에서 전화를 건 경우에만 Office 365에서 복구 작업을 시작 하며, Microsoft는 암호 해독 된 TIK 및 새 집합을 사용 하 여 해당 사용자의 비밀 저장소에 저장 된 가용성 키로 TIK를 해독 하 고 테 넌 트를 다시 보 딩 합니다. 고객이 제공한 Azure 키 보관소 키</span><span class="sxs-lookup"><span data-stu-id="2f198-231">Only if the customer calls Microsoft will Office 365 initiate the recovery operation, which involves decrypting the TIK with the availability key stored in Microsoft's secret store and onboarding the tenant again using the decrypted TIK and a new set of customer-supplied Azure Key Vault keys.</span></span>
  
<span data-ttu-id="2f198-232">현재로 서는 고객 키가 Azure blob 저장소에 저장 된 SharePoint Online 파일 데이터의 암호화 및 암호 해독 체인에 포함 되지만 SharePoint Online 목록 항목이 나 SQL 데이터베이스에 저장 된 메타 데이터는 제외 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-232">As of today, Customer Key is involved in the encryption and decryption chain of SharePoint Online file data stored in the Azure blob store, but not SharePoint Online list items or metadata stored in the SQL database.</span></span> <span data-ttu-id="2f198-233">Office 365에서 Exchange Online, 비즈니스용 Skype, SharePoint Online, 비즈니스용 OneDrive 및 위에 설명 된 사례 (고객 시작)에 게는 가용성 키를 사용 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-233">Office 365 does not use the availability key for Exchange Online, Skype for Business, SharePoint Online, OneDrive for Business, and Teams files other than the case described above, which is customer-initiated.</span></span> <span data-ttu-id="2f198-234">고객 데이터에 대 한 사용자 액세스는 고객 Lockbox에 의해 보호 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-234">Human access to customer data is protected by Customer Lockbox.</span></span>

## <a name="availability-key-triggers"></a><span data-ttu-id="2f198-235">가용성 키 트리거</span><span class="sxs-lookup"><span data-stu-id="2f198-235">Availability key triggers</span></span>

<span data-ttu-id="2f198-236">Office 365에서는 특정 상황 에서만 가용성 키를 트리거합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-236">Office 365 triggers the availability key only in specific circumstances.</span></span> <span data-ttu-id="2f198-237">이러한 상황은 서비스에 따라 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-237">These circumstances differ by service.</span></span>

### <a name="triggers-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="2f198-238">Exchange Online 및 비즈니스용 Skype에 대 한 트리거</span><span class="sxs-lookup"><span data-stu-id="2f198-238">Triggers for Exchange Online and Skype for Business</span></span>
  
1. <span data-ttu-id="2f198-239">Office 365에서는 Azure 키 자격 증명 모음에서 두 고객 키의 위치를 확인 하기 위해 사서함이 할당 되는 DEP를 읽습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-239">Office 365 reads the DEP to which the mailbox is assigned in order to determine the location of the two Customer Keys in Azure Key Vault.</span></span>

2. <span data-ttu-id="2f198-240">Office 365은 DEP에서 두 개의 고객 키 중 하나를 선택 하 고 Azure Key Vault에 요청을 보내 고객 키를 사용 하 여 DEP 키를 래핑 해제 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-240">Office 365 randomly chooses one of the two Customer Keys from the DEP and sends a request to Azure Key Vault to unwrap the DEP key using the Customer Key.</span></span>

3. <span data-ttu-id="2f198-241">고객 키를 사용 하 여 DEP 키의 래핑을 해제 하는 요청이 실패 하면 Office 365에서 Azure 키 보관소로 두 번째 요청을 보내 대체 (두 번째) 고객 키를 사용 하도록 지시 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-241">If the request to unwrap the DEP key using the Customer Key fails, Office 365 sends a second request to Azure Key Vault, this time instructing it to use the alternate (second) Customer Key.</span></span>

4. <span data-ttu-id="2f198-242">고객 키를 사용 하 여 DEP 키의 래핑을 해제 하는 두 번째 요청이 실패 하면 Office 365에서 두 요청의 결과를 검사 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-242">If the second request to unwrap the DEP key using the Customer Key fails, Office 365 examines the results of both requests.</span></span>

    - <span data-ttu-id="2f198-243">검사 결과, 요청이 시스템 오류를 반환 하는 데 실패 한 것으로 확인 된 경우:</span><span class="sxs-lookup"><span data-stu-id="2f198-243">If the examination determines that the requests failed returning a system ERROR:</span></span>

       - <span data-ttu-id="2f198-244">Office 365에서 가용성 키를 트리거하여 DEP 키의 암호를 해독 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-244">Office 365 triggers the availability key to decrypt the DEP key.</span></span>

       - <span data-ttu-id="2f198-245">그런 다음 Office 365에서는 DEP 키를 사용 하 여 사서함 키의 암호를 해독 하 고 사용자 요청을 완료 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-245">Office 365 then uses the DEP key to decrypt the mailbox key and complete the user request.</span></span> 

       - <span data-ttu-id="2f198-246">이 경우 Azure 키 보관소가 일시적인 오류로 인해 응답 하지 않거나 연결할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-246">In this case, Azure Key Vault is either unable to respond or unreachable due to a transient ERROR.</span></span>

    - <span data-ttu-id="2f198-247">검사 결과 요청이 거부 된 액세스를 반환 하지 못했음을 확인 한 경우:</span><span class="sxs-lookup"><span data-stu-id="2f198-247">If the examination determines that the requests failed returning ACCESS DENIED:</span></span>

       - <span data-ttu-id="2f198-248">즉, 서비스를 종료 하는 과정에서 데이터 제거 프로세스 중에 사용자 키를 사용할 수 없게 되는 경우를 위해 의도적인, 실수로 또는 악성 작업을 수행 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-248">This means deliberate, inadvertent, or malicious action has been taken to render the customer keys unavailable (for example, during the data purge process as part of leaving the service).</span></span>

       - <span data-ttu-id="2f198-249">이 경우에는 가용성 키가 사용 되지 않으며 사용자 요청이 실패 하 고 사용자가 오류 메시지를 받게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-249">In this case, the availability key will not be used, the user request fails, and the user receives an error message.</span></span>

>[!IMPORTANT]
><span data-ttu-id="2f198-250">Office 365 서비스 코드는 항상 고객 데이터를 통해 가치를 더하는 클라우드 서비스를 제공 하는 데 사용할 수 있는 유효한 로그인 토큰을 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-250">Office 365 service code always has a valid login token for reasoning over customer data to provide value-adding cloud services.</span></span> <span data-ttu-id="2f198-251">따라서 가용성 키가 삭제 될 때 까지는 검색 인덱스를 만들거나 사서함을 이동 하는 등의 작업을 시작 하거나 내부에서 Exchange Online 및 비즈니스용 Skype의 대체로 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-251">Therefore, until the availability key has been deleted, it can be used as a fallback for actions initiated by, or internal to, Exchange Online and Skype for Business such as search index creation or moving mailboxes.</span></span> <span data-ttu-id="2f198-252">이는 Azure 키 자격 증명에 대 한 일시적인 오류 및 액세스 거부 요청에 모두 적용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-252">This applies to both transient ERRORS and ACCESS DENIED requests to Azure Key Vault.</span></span>

### <a name="triggers-for-sharepoint-online-onedrive-for-business-and-teams-files"></a><span data-ttu-id="2f198-253">SharePoint Online, 비즈니스용 OneDrive 및 팀 파일에 대 한 트리거</span><span class="sxs-lookup"><span data-stu-id="2f198-253">Triggers for SharePoint Online, OneDrive for Business, and Teams files</span></span>

<span data-ttu-id="2f198-254">SharePoint Online, 비즈니스용 OneDrive 및 팀 파일의 경우 가용성 키가 복구 기능 외부에서 사용 되지 않으며, 고객은 복구 시나리오에서 가용성 키 사용을 시작 하도록 Microsoft에 명시적으로 지시 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-254">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is NEVER used outside of the recovery capability and customers must explicitly instruct Microsoft to initiate use of the availability key during a recovery scenario.</span></span>

## <a name="audit-logs-and-the-availability-key"></a><span data-ttu-id="2f198-255">감사 로그 및 가용성 키</span><span class="sxs-lookup"><span data-stu-id="2f198-255">Audit logs and the availability key</span></span>

<span data-ttu-id="2f198-256">Office 365의 자동화 된 시스템은 시스템을 통해 전달 되는 모든 데이터를 처리 하 여 바이러스 백신, 전자 검색, 데이터 손실 방지 및 데이터 인덱싱과 같은 클라우드 서비스를 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-256">Automated systems in Office 365 process all data as it flows through the system to provide cloud services, for example, anti-virus, e-discovery, data loss prevention, and data indexing.</span></span> <span data-ttu-id="2f198-257">Office 365에서이 작업에 대해 고객에 게 표시 되는 로그를 생성 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-257">Office 365 does not generate customer-visible logs for this activity.</span></span> <span data-ttu-id="2f198-258">또한 Microsoft 직원은 이러한 일반 시스템 작업의 일부로 데이터에 액세스 하지 못합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-258">In addition, Microsoft personnel do not access your data as part of these normal system operations.</span></span>

### <a name="exchange-online-and-skype-for-business-availability-key-logging"></a><span data-ttu-id="2f198-259">Exchange Online 및 비즈니스용 Skype 가용성 키 로깅</span><span class="sxs-lookup"><span data-stu-id="2f198-259">Exchange Online and Skype for Business availability key logging</span></span>

<span data-ttu-id="2f198-260">Exchange Online 및 비즈니스용 Skype는 일시적으로 오류가 발생 하는 동안 가용성 키를 자동으로 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-260">Exchange Online and Skype for Business automatically use the availability key during transient errors.</span></span> <span data-ttu-id="2f198-261">이 폴백 문제가 발생 하면 Office 365에서 보안 및 준수 센터에서 액세스할 수 있는 고객에 게 표시 가능한 로그를 게시 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-261">When this fallback occurs, Office 365 publishes customer-visible logs accessible from the Security and Compliance Center.</span></span> <span data-ttu-id="2f198-262">가용성 키 작업에 대 한 감사 로그 레코드는 해당 서비스가 가용성 키를 사용 하 여 전환할 때마다 생성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-262">An audit log record for the availability key operation is generated each time these services switch to using the availability key.</span></span> <span data-ttu-id="2f198-263">"고객 키 서비스 암호화" 라는 새 레코드 유형 (활동 유형이 "Fallback to Availability Key")을 사용 하면 관리자가 [통합 감사 로그](https://docs.microsoft.com/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance) 검색 결과를 필터링 하 여 가용성 키 레코드를 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-263">A new record type called “Customer Key Service Encryption” with activity type "Fallback to Availability Key" allows admins to filter [Unified Audit Log](https://docs.microsoft.com/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance) search results to view availability key records.</span></span> <span data-ttu-id="2f198-264">가용성 키 레코드는 고객 키가 Microsoft 서비스 관리 키가 아닌 데이터에 액세스 하는 데 사용 되는 경우에만 생성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-264">The availability key record gets generated only when Customer Key is used to access the data and not for Microsoft service-managed keys.</span></span>

<span data-ttu-id="2f198-265">로그 레코드에는 날짜, 시간, 활동, 조직 ID 및 데이터 암호화 정책 ID와 같은 특성이 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-265">Log records include attributes such as date, time, activity, organization ID, and data encryption policy ID.</span></span> <span data-ttu-id="2f198-266">이 레코드는 Office 365 통합 감사 로그의 일부로 사용 가능 하며, Office 365 보안 및 준수 센터 감사 로그 검색 탭에서 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-266">The record is available as part of Office 365 Unified Audit Logs and is accessible from the Office 365 Security and Compliance Center Audit Log Search tab.</span></span>

![가용성 키 이벤트에 대 한 감사 로그 검색](media/customerkeyauditlogsearchavailabilitykeyloggingimage.png)

<span data-ttu-id="2f198-268">Exchange Online 및 비즈니스용 Skype 가용성 키 레코드는 사용자 지정 매개 변수 정책 Id, 범위 키 버전 Id 및 요청 Id와 함께 Office 365 관리 작업 [일반 스키마](https://docs.microsoft.com/office/office-365-management-api/office-365-management-activity-api-schema#common-schema) 를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-268">Exchange Online and Skype for Business availability key records use the Office 365 Management Activity [common schema](https://docs.microsoft.com/office/office-365-management-api/office-365-management-activity-api-schema#common-schema) with added custom parameters: Policy Id, Scope Key Version Id, and Request Id.</span></span>

![가용성 키 사용자 지정 매개 변수](media/customerkeyauditlogsearchavailabilitykeyloggingcustomparam.png)

### <a name="sharepoint-online-onedrive-for-business-and-teams-files-availability-key-logging"></a><span data-ttu-id="2f198-270">SharePoint Online, 비즈니스용 OneDrive 및 팀 파일 가용성 키 로깅</span><span class="sxs-lookup"><span data-stu-id="2f198-270">SharePoint Online, OneDrive for Business, and Teams files availability key logging</span></span>

<span data-ttu-id="2f198-271">이러한 서비스에 대해서는 가용성 키 로깅을 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-271">Availability key logging isn't available yet for these services.</span></span> <span data-ttu-id="2f198-272">SharePoint Online, 비즈니스용 OneDrive 및 팀 파일의 경우 가용성 키는 사용자가 복구를 위해 지시한 경우에만 정품 인증을 받아야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-272">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is only activated by Microsoft, when instructed by you, for recovery purposes.</span></span> <span data-ttu-id="2f198-273">따라서 이러한 서비스에 대 한 가용성 키가 사용 되는 모든 이벤트를 이미 알고 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-273">As a result, you already know every event in which the availability key is used for these services.</span></span>

## <a name="availability-key-in-the-customer-key-hierarchy"></a><span data-ttu-id="2f198-274">고객 키 계층 구조의 가용성 키</span><span class="sxs-lookup"><span data-stu-id="2f198-274">Availability key in the Customer Key hierarchy</span></span>
  
<span data-ttu-id="2f198-275">Office 365에서는 가용성 키를 사용 하 여 고객 키 서비스 암호화에 대해 설정 된 키 계층 구조의 아래쪽에 있는 키의 계층을 래핑합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-275">Office 365 uses the availability key to wrap the tier of keys lower in the key hierarchy established for Customer Key service encryption.</span></span> <span data-ttu-id="2f198-276">서비스 간에는 서로 다른 주요 계층 구조가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-276">Different key hierarchies exist between services.</span></span> <span data-ttu-id="2f198-277">또한 주요 알고리즘은 적용 가능한 각 서비스의 계층 구조에 있는 다른 키와 가용성 키 사이에도 차이가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-277">Key algorithms also differ between availability keys and other keys in the hierarchy of each applicable service.</span></span> <span data-ttu-id="2f198-278">서로 다른 서비스에서 사용 하는 가용성 키 알고리즘은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-278">The availability key algorithms used by the different services are as follows:</span></span>

- <span data-ttu-id="2f198-279">Exchange Online 및 비즈니스용 Skype 가용성 키는 AES-256를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-279">The Exchange Online and Skype for Business availability keys use AES-256.</span></span>

- <span data-ttu-id="2f198-280">SharePoint Online, 비즈니스용 OneDrive 및 팀 파일 가용성 키는 RSA-2048을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="2f198-280">The SharePoint Online, OneDrive for Business, and Teams files availability keys use RSA-2048.</span></span>

### <a name="encryption-ciphers-used-to-encrypt-keys-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="2f198-281">Exchange Online 및 비즈니스용 Skype에 대 한 키를 암호화 하는 데 사용 되는 암호화 암호</span><span class="sxs-lookup"><span data-stu-id="2f198-281">Encryption ciphers used to encrypt keys for Exchange Online and Skype for Business</span></span>

![Exchange Online 고객 키에 대 한 암호화 암호](media/customerkeyencryptionhierarchiesexchangeskype.png)

### <a name="encryption-ciphers-used-to-encrypt-keys-for-sharepoint-online-and-onedrive-for-business"></a><span data-ttu-id="2f198-283">SharePoint Online 및 비즈니스용 OneDrive의 키를 암호화 하는 데 사용 되는 암호화 암호</span><span class="sxs-lookup"><span data-stu-id="2f198-283">Encryption ciphers used to encrypt keys for SharePoint Online and OneDrive for Business</span></span>

![SharePoint Online 고객 키에 대 한 암호화 암호](media/customerkeyencryptionhierarchiessharepointonedriveteamsfiles.png)

## <a name="related-articles"></a><span data-ttu-id="2f198-285">관련 문서</span><span class="sxs-lookup"><span data-stu-id="2f198-285">Related articles</span></span>

- [<span data-ttu-id="2f198-286">Office 365에 대 한 고객 키를 사용한 서비스 암호화</span><span class="sxs-lookup"><span data-stu-id="2f198-286">Service encryption with Customer Key for Office 365</span></span>](customer-key-overview.md)

- [<span data-ttu-id="2f198-287">Office 365에 대 한 고객 키 설정</span><span class="sxs-lookup"><span data-stu-id="2f198-287">Set up Customer Key for Office 365</span></span>](customer-key-set-up.md)

- [<span data-ttu-id="2f198-288">Office 365에 대 한 고객 키 관리</span><span class="sxs-lookup"><span data-stu-id="2f198-288">Manage Customer Key for Office 365</span></span>](customer-key-manage.md)

- [<span data-ttu-id="2f198-289">고객 키 또는 가용성 키 롤 또는 회전</span><span class="sxs-lookup"><span data-stu-id="2f198-289">Roll or rotate a Customer Key or an availability key</span></span>](customer-key-availability-key-roll.md)
